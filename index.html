<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Deck Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-100 text-gray-800 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white p-8 rounded-2xl shadow-lg text-center max-w-lg w-full">
        <h1 class="text-2xl font-bold text-blue-600 mb-2">Master Deck Setup Tool</h1>
        <p class="text-gray-600 mb-6">Use this tool only once to populate the master HSK decks in your database. This may take several minutes. Do not close this window until you see a success message.</p>
        <button id="build-decks-btn" class="w-full bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors flex items-center justify-center">
            Build Master Decks
        </button>
        <p id="status-message" class="text-blue-600 text-sm mt-4 h-4"></p>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, doc, writeBatch } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const buildDecksBtn = document.getElementById('build-decks-btn');
        const statusMessage = document.getElementById('status-message');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        let db;

        const firebaseConfig = {
            apiKey: "AIzaSyDLb2nmy5HYNNNTdS87pdDqLZk7TkVK-Rc",
            authDomain: "mand12cards.firebaseapp.com",
            projectId: "mand12cards",
            storageBucket: "mand12cards.appspot.com",
            messagingSenderId: "916004335850",
            appId: "1:916004335850:web:1a967ff0f3d26843f16793"
        };

        const app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        const auth = getAuth(app);
        signInAnonymously(auth);

        const getMasterDeckCollectionPath = (deckId) => `artifacts/${appId}/public/data/master_decks/${deckId}/cards`;

        const populateMasterDecks = async () => {
            buildDecksBtn.disabled = true;
            buildDecksBtn.textContent = "Building...";

            const hsk2Data = `我;wǒ;I, me
我们;wǒmen;we, us
你;nǐ;you
你们;nǐmen;you (plural)
他;tā;he, him
她;tā;she, her
他们;tāmen;they (male + female/male)
她们;tāmen;they (female)
您;nín;you
它;tā;it
大家;dàjiā;everyone
每;měi;every
这(这儿);zhè (zhèr);here, this
那(那儿);nà (nàr);there, that
哪（哪儿）;nǎ (nǎr);where
谁;shéi;who
什么;shénme;what, why
多少;duōshǎo;how many, how much
几;jǐ;a few, how many
怎么;zěnme;how
怎么样;zěnmeyàng;how about
为什么;wèishénme;why
一;yī;one
二;èr;two
三;sān;three
四;sì;four
五;wǔ;five
六;liù;six
七;qī;seven
八;bā;eight
九;jiǔ;nine
十;shí;ten
零;líng;zero
两;liǎng;two
百;bǎi;hundred
千;qiān;thousand
第一;dìyī;first
个;gè;one, a, an
岁;suì;year
本;běn;volume
些;xiē;some
块;kuài;piece
次;cì;number
公斤;gōngjīn;kilogram
元;yuán;yuan
件;jiàn;piece
张;zhāng;sheet
不;bù;no
没;méi;no
很;hěn;quite, very
太;tài;too
都;dōu;all
别;bié;other
非常;fēicháng;very
也;yě;likewise
还;hái;repay
最;zuì;most
真;zhēn;real
正在;zhèngzài;be being
已经;yǐjīng;already
一起;yìqǐ;together
再;zài;again
就;jiǜ;at once
和;hé;and
因为;yīnwèi;because
所以;suǒyǐ;so
但是;dànshì;but
在;zài;in, at
从;cóng;from
对;duì;right
此;cǐ;this
向;xiàng;towards
离;lí;leave
喂;wèi;hello
家;jiā;home
学校;xuéxiào;school
饭馆;fàn guǎn;restaurant
商店;shāngdiàn;store
医院;yīyuàn;hospital
火车站;huǒchēzhàn;train station
中国;zhōngguó;China
机场;jīchǎng;airport
教室;jiàoshì;classroom
房间;fángjiān;room
路;lù;road
北京;běijīng;Beijing
上;shàng;up
下;xià;below
前面;qiánmiàn;front
后面;hòumiàn;behind
左边;zuǒbiān;left
右边;yòubiān;right
外;wài;out
旁边;pángbiān;side
里面;lǐmiàn;inside
今天;jīntiān;today
明天;míngtiān;tomorrow
昨天;zuótiān;yesterday
上午;shàngwǔ;morning
中午;zhōngwǔ;noon
下午;xiàwǔ;afternoon
年;nián;year
月;yuè;month
日;rì;day
星期;xīngqī;week
点;diǎn;dot, spot
分钟;fēnzhōng;minute
现在;xiànzài;now
时候;shíhóu;time
早上;zǎoshàng;morning
晚上;wǎnshàng;night
小时;xiǎoshí;hour
时间;shíjiān;time
去年;qùnián;last year
号;hào;number
生日;shēngrì;birthday
爸爸;bàba;father
妈妈;māma;mother
儿子;érzi;son
女儿;nǚér;daughter
老师;lǎoshī;teacher
学生;xuéshēng;student
同学;tóngxué;shoolmate
朋友;péngyǒu;friend
医生;yīshēng;doctor
先生;xiānshēng;sir
小姐;xiǎojiě;Miss
哥哥;gēge;brother
姐姐;jiějie;sister
弟弟;dìdi;younger brother
妹妹;mèimei;sis
丈夫;zhàngfu;husband
妻子;qīzi;wife
孩子;háizi;child
男人;nánrén;man
女人;nǚrén;woman
服务员;fúwùyuán;waiter
衣服;yīfu;cloth
水;shuǐ;water
菜;cài;vegetable
米饭;mǐfàn;rice
水果;shuǐguǒ;fruit
苹果;píngguǒ;apple
茶;chá;tea
杯子;bēizi;cup
钱;qián;money
飞机;fēijī;airplane
出租车;chūzūchē;taxi
电视;diànshì;television
电脑;diànnǎo;computer
电影;diànyǐng;movie
天气;tiānqì;weather
猫;māo;cat
狗;gǒu;dog
东西;dōngxī;thing
鱼;yú;fish
羊肉;yángròu;mutton
牛奶;niúnǎi;milk
鸡蛋;jīdàn;egg
西瓜;xīguā;watermelon
咖啡;kāfēi;coffee
自行车;zìxíngchē;bike
船;chuán;boat
雪;xué;snow
药;yào;medicine
手机;shǒujī;phone
手表;shǒubiǎo;watch
眼睛;yǎnjīng;eye
身体;shēntǐ;body
公共汽车;gōnggòngqìchē;bus
报纸;bàozhǐ;newspaper
人;rén;person
名字;míngzi;name
书;shū;book
汉语;hànyǔ;Chinese
字;zì;character
桌子;zhuōzi;desk
椅子;yǐzi;chair
门;mén;door
题;tí;topic
课;kè;lesson
姓;xìng;surname
问题;wèntí;question
事情;shìqing;matter
考试;kǎoshì;exam
票;piào;ticket
意思;yìsi;meaning
颜色;yánsè;color
谢谢;xièxiè;thank
不客气;búkèqì;you are welcome
再见;zàijiàn;good-bye
请;qǐng;please
对不起;duìbùqǐ;sorry
没关系;méiguānxì;It doesn't matter
欢迎;huānyíng;welcome
是;shì;am, is, are
有;yǒu;have
看;kàn;look
听;tīng;listen
说话;shuōhuà;speak
读;dú;read
写;xiě;write
看见;kànjiàn;see
叫;jiào;call
来;lái;come
回;huí;return
去;qù;go
吃;chī;eat
喝;hē;drink
睡觉;shuìjiào;sleep
打电话;dǎdiànhuà;call up
做;zuò;do
买;mǎi;buy
开;kāi;open
坐;zuò;sit
住;zhù;live
学习;xuéxí;study
工作;gōngzuò;work
下雨;xiàyǔ;rain
问;wèn;ask
走;zǒu;walk
进;jìn;enter
出;chū;come
跑步;pǎobù;run
到;dào;arrive
穿;chuān;wear
洗;xǐ;wash
给;gěi;give
找;zhǎo;find
懂;dǒng;understand
笑;xiào;smile
回答;huídá;answer
告诉;gàosù;tell
准备;zhǔnbèi;prepare
开始;kāishǐ;begin
介绍;jièshào;introduce
帮助;bāngzhù;help
玩;wán;play
送;sòng;present
等;děng;wait
让;ràng;let
起床;qǐchuáng;get up
唱歌;chànggē;sing
跳舞;tiàowǔ;dance
旅游;lǚyóu;travel
上班;shàngbān;be on duty
生病;shēngbìng;fall ill
休息;xiūxi;rest
运动;yùndòng;exercise
游泳;yóuyǒng;swim
踢足球;tīzúqiú;play footbal
打篮球;dǎlánqiú;play basketball
完;wán;finish
爱;ài;love
喜欢;xǐhuān;love, like
想;xiǎng;want
认识;rènshi;know
觉得;juédé;think
知道;zhīdào;know
希望;xīwàng;hope
会;huì;can
能;néng;can, be able
可以;kěyǐ;can
要;yào;ask for
可能;kěnéng;may
好;hǎo;good
大;dà;big
小;xiǎo;small
多;duō;many, much
少;shǎo;few, little
冷;lěng;cold
热;rè;hot
高兴;gāoxìng;happy
漂亮;piàoliàng;beautiful
高;gāo;tall
红;hóng;red
白;bái;white
黑;hēi;black
忙;máng;busy
快;kuài;fast
慢;màn;slow
远;yuǎn;far
近;jìn;close
好吃;hǎochī;delicious
累;lèi;tired
长;cháng;long
新;xīn;new
贵;guì;expensive
便宜;piányi;cheap
晴;qíng;fine
阴;yīn;cloudy
错;cuò;wrong
快乐;kuàilè;happy`;
            
            const hsk3Data = `阿姨;āyí;aunt
啊;a;ah
矮;ǎi;short
爱好;àihào;hobby
安静;ānjìng;Be quiet
把;bǎ;hold
班;bān;class
搬;bān;turn; pull
半;bàn;half
办法;bànfǎ;Way
办公室;bàngōngshì;Office
帮忙;bāngmáng;Help
包;bāo;package
饱;bǎo;full
北方;běifāng;north
被;bèi;cover
鼻子;bízi;nose
比;bǐ;than
比较;bǐjiào;compare
比赛;bǐsài;Match
必须;bìxū;Must
变化;biànhà;change
表示;biǎoshì;Express
表演;biǎoyǎn;perform
别人;biéren;Others
宾馆;bīnguǎn;hotel
冰箱;bīngxiāng;Refrigerator
才;cái;just
菜单;càidān;menu
参加;cānjiā;participate in
草;cǎo;grass
层;céng;layer
差;chà;difference
超市;chāoshì;Supermarket
衬衫;chènshān;shirt
成绩;chéngjì;achievement
城市;chéngshì;City
迟到;chídào;Late
出现;chūxiàn;Appear
厨房;chúfáng;Kitchen
除了;chúle;except
春;chūn;spring
词语;cíyǔ;terms
聪明;cōngming;clever
打扫;dǎsǎo;Clean
打算;dǎsuàn;Plan
带;dài;belt
担心;dānxīn;Worry
蛋糕;dàngāo;Cake
当然;dāngrán;Of course
灯;dēng;lamp
低;dī;low
地方;dìfang;local
地铁;dìtiě;metro
地图;dìtú;Map
电梯;diàntī;Elevator
电子邮件;diànzǐyóujiàn;E-mail
东;dōng;east
冬;dōng;winter
动物;dòngwù;Animal
短;duǎn;short
段;duàn;paragraph
锻炼;duànliàn;Physical exercise
多么;duōme;what
饿;è;hungry
而且;érqiě;And
耳朵;ěrduo;Ears
发烧;fāshāo;Have a fever
发现;fāxiàn;find
方便;fāngbiàn;convenient
放;fàng;discharge
放心;fàngxīn;Don't worry
分;fēn;branch
附近;fùjìn;nearby
复习;fùxí;Review
干净;gānjìng;clean
敢;gǎn;dare
感冒;gǎnmào;Cold
刚才;gāngcái;just
根据;gēnjù;according to
跟;gēn;with
更;gèng;more
公司;gōngsī;company
公园;gōngyuán;Park
故事;gùshi;Story
刮风;guāfēng;Windy
关;guān;shut
关系;guānxì;relationship
关心;guānxīn;Care for
关于;guānyú;about
国家;guójiā;Country
果汁;guǒzhī;fruit juice
过去;guòqù;Past times
还是;háishì;still
害怕;hàipà;Fear
黑板;hēibǎn;blackboard
后来;hòulái;later
护照;hùzhào;passport
花;huā;Flower
花园;huāyuán;Garden
画;huà;painting
坏;huài;bad
还;huán;still
环境;huánjìng;Environmental Science
换;huàn;change
黄;huáng;yellow
会议;huìyì;Meeting
或者;huòzhě;perhaps
几乎;jīhū;almost
机会;jīhuì;Opportunity
极;jí;extremely
记得;jìde;remember
季节;jìjié;Season
检查;jiǎnchá;inspect
简单;jiǎndān;simple
健康;jiànkāng;Healthy
见面;jiànmiàn;meet
讲;jiǎng;speak
教;jiāo;teach
角;jiǎo;horn
脚;jiǎo;foot
接;jiē;meet
街道;jiēdào;Street
结婚;jiéhūn;marry
结束;jiéshù;End
节目;jiémù;program
节日;jiérì;festival
解决;jiějué;Solve
借;jiè;borrow
经常;jīngcháng;Often
经过;jīngguò;after
经理;jīnglǐ;manager
久;jiǔ;long
旧;jiù;used
举行;jǔxíng;hold
句子;jùzi;sentence
决定;juédìng;Decision
渴;kě;thirsty
可爱;kě'ài;Lovely
刻;kè;moment
客人;kèrén;Guest
空调;kōngtiáo;Air conditioner
口;kǒu;mouth
哭;kū;cry
裤子;kùzi;trousers
筷子;kuàizi;chopsticks
蓝;lán;blue
老;lǎo;old
离开;líkāi;leave
礼物;lǐwù;gift
历史;lìshǐ;History
脸;liǎn;face
练习;liànxí;Practice
辆;liàng;Car
了解;liǎojiě;understand
邻居;línjū;neighbor
楼;lóu;floor
绿;lǜ;green
马;mǎ;Horse
马上;mǎshàng;Right off
卖;mài;sell
满意;mǎnyì;Satisfied
帽子;màozi;Hat
米;mǐ;rice
面包;miànbāo;Bread
面条;miàntiáo;noodle
明白;míngbai;clear
拿;ná;take
奶奶;nǎinai;grandma
南;nán;south
难;nán;disaster; blame
难过;nánguò;Sorry
年级;niánjí;grade
年轻;niánqīng;Young
鸟;niǎo;bird
努力;nǔlì;Strive
爬山;páshān;Mountain climbing
盘子;pánzi;plate
胖;pàng;fat
啤酒;píjiǔ;Beer
葡萄;pútao;Grape
普通话;pǔtōnghuà;Mandarin
其实;qíshí;actually
其他;qítā;Other
骑;qí;ride
奇怪;qíguài;strange
铅笔;qiānbǐ;pencil
清楚;qīngchu;clear
秋;qiū;autumn
裙子;qúnzi;skirt
然后;ránhòu;Then
热情;rèqíng;Enthusiasm
认为;rènwéi;think
认真;rènzhēn;earnest
容易;róngyì;easily
如果;rúguǒ;If
伞;sǎn;umbrella
上网;shàngwǎng;Surf the Internet
生气;shēngqì;get angry
声音;shēngyīn;voice
使;shǐ;send
世界;shìjiè;world
瘦;shòu;thin
舒服;shūfu;comfortable
叔叔;shūshu;uncle
树;shù;tree
数学;shùxué;Mathematics
刷牙;shuāyá;Brush one's teeth
双;shuāng;double
水平;shuǐpíng;level
司机;sījī;Driver
虽然;suīrán;although
太阳;tàiyáng;sunlight
糖;táng;sugar
特别;tèbié;Especially
疼;téng;They hurt
提高;tígāo;increase
体育;tǐyù;Sports
甜;tián;sweet
条;tiáo;strip
同事;tóngshì;Colleague
同意;tóngyì;Agree
头发;tóufa;Hair
突然;tūrán;suddenly
图书馆;túshūguǎn;Library
腿;tuǐ;leg
完成;wánchéng;complete
碗;wǎn;bowl
万;wàn;ten thousand
忘记;wàngjì;forget
为;wèi;by
为了;wèile;in order to
位;wèi;position
文化;wénhuà;Culture
西;xī;west
习惯;xíguàn;Habit
洗手间;xǐshǒujiān;Restroom
洗澡;xǐzǎo;Take a shower
夏;xià;summer
先;xiān;before
香蕉;xiāngjiāo;Banana
相同;xiāngtóng;identical
相信;xiāngxìn;believe
像;xiàng;image
小心;xiǎoxīn;Look out
校长;xiàozhǎng;Principal
鞋;xié;shoes
新闻;xīnwén;Journalism
新鲜;xīnxiān;fresh
信;xìn;letter
行李箱;xínglixiāng;Trunk
兴趣;xìngqù;Interest
熊猫;xióngmāo;Panda
需要;xūyào;Need
选择;xuǎnzé;Choice
要求;yāoqiú;Requirement
爷爷;yéye;grandpa
一定;yídìng;Certain
一共;yígòng;Altogether
一会儿;yíhuìr;A little while
一样;yíyàng;equally
以后;yǐhòu;In the future
以前;yǐqián;before
以为;yǐwéi;Think
一般;yìbān;commonly
一边;yìbiān;One side
一直;yìzhí;always
阴;yīn;Yin
音乐;yīnyuè;Music
银行;yínháng;Bank
应该;yīnggāi;Should
影响;yǐngxiǎng;Influence
用;yòng;use
游戏;yóuxì;Game
有名;yǒumíng;Famous
又;yòu;also
遇到;yùdào;encounter
愿意;yuànyì;Be willing
月亮;yuèliang;Moon
越;yuè;The more
云;yún;cloud
站;zhàn;station
长;zhǎng;long
着急;zháojí;Worry
照顾;zhàogù;look after
照片;zhàopiàn;Photo
照相机;zhàoxiàngjī;Camera
只;zhǐ;only
中间;zhōngjiān;Middle
终于;zhōngyú;finally
种;zhǒng;species
重要;zhòngyào;important
周末;zhōumò;Weekend
主要;zhǔyào;main
祝;zhù;wish
注意;zhùyì;Be careful
字典;zìdiǎn;Dictionaries
自己;zìjǐ;Own
总是;zǒngshì;always
最近;zuìjìn;Lately
作业;zuòyè;homework
作用;zuòyòng;Effect`;
            
            const vocabList = (dataString) => {
                return dataString.trim().split('\n').map(line => {
                    const parts = line.trim().split(';');
                    if (parts.length < 3) return null;
                    const [front, pinyin, english] = parts;
                    return { front: front.trim(), back: `${pinyin.trim()} - ${english.trim()}` };
                }).filter(Boolean);
            };

            const hsk2Cards = vocabList(hsk2Data);
            const hsk3Cards = vocabList(hsk3Data);

            const addCardsToBatch = async (cards, deckName, updateProgress) => {
                const collectionRef = collection(db, getMasterDeckCollectionPath(deckName));
                const batchSize = 100;
                for (let i = 0; i < cards.length; i += batchSize) {
                    const batch = writeBatch(db);
                    const chunk = cards.slice(i, i + batchSize);
                    chunk.forEach(word => {
                        const newCard = { front: word.front, back: word.back };
                        const cardRef = doc(collectionRef);
                        batch.set(cardRef, newCard);
                    });
                    await batch.commit();
                    if(updateProgress) updateProgress(chunk.length);
                }
            };
            
            let totalCards = hsk2Cards.length + hsk3Cards.length + (hsk2Cards.length + hsk3Cards.length);
            let cardsLoaded = 0;
            const updateProgress = (batchSize) => {
                cardsLoaded += batchSize;
                statusMessage.textContent = `Building... ${cardsLoaded}/${totalCards}`;
            };
            
            await addCardsToBatch(hsk2Cards, 'hsk2', updateProgress);
            await addCardsToBatch(hsk3Cards, 'hsk3', updateProgress);
            await addCardsToBatch([...hsk2Cards, ...hsk3Cards], 'complete', updateProgress);
            
            buildDecksBtn.textContent = "Decks Built Successfully!";
            statusMessage.textContent = `Completed ${cardsLoaded} cards.`;
            console.log('Master decks populated');
        };

        buildDecksBtn.addEventListener('click', populateMasterDecks);

    </script>
</body>
</html>

